{% extends "base.html" %}

{% block title %}Выбор материалов — {{ source_name }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3>Источник: {{ source_name }}</h3>

  <form method="post" action="/iacpaas/llm_parsing/">
    {% csrf_token %}
    <input type="hidden" name="source" value="{{ source_id }}">

    <div class="mt-3 mb-3">
      <button type="button" class="btn btn-outline-primary me-2" onclick="toggleAll(true)">Выбрать все</button>
      <button type="button" class="btn btn-outline-secondary me-2" onclick="toggleAll(false)">Снять все</button>
      <button type="submit" class="btn btn-success">Далее</button>
    </div>

  <div class="form-check mb-3">
  <input class="form-check-input" type="checkbox" name="use_preload" id="use_preload" checked>
  <label class="form-check-label" for="use_preload">
    Предзагрузка
  </label>
</div>

    <ul class="list-group">
      {% for link in links %}
        <li class="list-group-item d-flex align-items-center">
          <input
            type="checkbox"
            name="selected_links"
            value="{{ link.id }}"
            id="link_{{ link.id }}"
            checked
          >
          <label class="ms-2 mb-0" for="link_{{ link.id }}">
            {{ link.link }}
          </label>
        </li>
      {% empty %}
        <li class="list-group-item">Нет материалов для отображения</li>
      {% endfor %}
    </ul>

  </form>
</div>

<script>
  function toggleAll(flag) {
    const checkboxes = document.querySelectorAll('input[name="selected_links"]');
    checkboxes.forEach(cb => cb.checked = flag);
  }
</script>
{% endblock %}
